<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>✏️ Edit Game Turn</h1>
        <a href="/admin/game_turns" class="btn btn-secondary">← Back to Game Turns</a>
    </div>

    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">Turn <%= turn.turn_number %> Details</h5>
        </div>
        <div class="card-body">
            <form method="POST" action="/admin/game_turns/edit/<%= turn.id %>">
                <div class="row">
                                         <div class="col-md-4">
                         <div class="mb-3">
                             <label for="turn_number" class="form-label">Turn Number</label>
                             <input type="text" 
                                    class="form-control" 
                                    id="turn_number" 
                                    value="<%= turn.turn_number %>" 
                                    readonly 
                                    disabled>
                             <div class="form-text">Turn number cannot be changed</div>
                         </div>
                     </div>
                     <div class="col-md-4">
                         <div class="mb-3">
                             <label for="status" class="form-label">Status</label>
                             <input type="text" 
                                    class="form-control" 
                                    id="status" 
                                    value="<%= turn.status === 'pending' ? '⏳ Pending' : turn.status === 'active' ? '🔄 Active' : '✅ Completed' %>" 
                                    readonly 
                                    disabled>
                             <div class="form-text">Status cannot be changed</div>
                         </div>
                     </div>
                     <div class="col-md-4">
                         <div class="mb-3">
                             <label for="start_time" class="form-label">Start Time</label>
                             <input type="text" 
                                    class="form-control" 
                                    id="start_time" 
                                    value="<%= new Date(turn.start_time).toLocaleString() %>" 
                                    readonly 
                                    disabled>
                             <div class="form-text">Start time cannot be changed</div>
                         </div>
                     </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="end_time" class="form-label">End Time</label>
                                                         <input type="datetime-local" 
                                    class="form-control" 
                                    id="end_time" 
                                    name="end_time" 
                                    value="<%= typeof formData !== 'undefined' ? formData.end_time : new Date(turn.end_time).toLocaleString('sv-SE').slice(0, 16) %>" 
                                    required>
                            <div class="form-text">Must be in the future</div>
                            <div id="end_time_validation" class="form-text text-danger validation-error"></div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="command_deadline" class="form-label">Command Deadline</label>
                                                         <input type="datetime-local" 
                                    class="form-control" 
                                    id="command_deadline" 
                                    name="command_deadline" 
                                    value="<%= typeof formData !== 'undefined' ? formData.command_deadline : new Date(turn.command_deadline).toLocaleString('sv-SE').slice(0, 16) %>" 
                                    required>
                            <div class="form-text">Must be in the future and before end time</div>
                            <div id="command_deadline_validation" class="form-text text-danger validation-error"></div>
                        </div>
                    </div>
                </div>

                <% if (typeof validationError !== 'undefined' && validationError) { %>
                    <div class="alert alert-danger">
                        <strong>❌ Validation Error:</strong> <%= validationError %>
                    </div>
                <% } %>
                 
                <div class="alert alert-info">
                    <strong>💡 Tip:</strong> Only end time and command deadline can be edited. Both must be in the future, and command deadline must be before end time. Turn number, status, and start time are read-only.
                </div>

                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">
                        💾 Save Changes
                    </button>
                    <a href="/admin/game_turns" class="btn btn-outline-secondary">
                        ❌ Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
